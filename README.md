# Пояснения к программам  

![main.py](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/main.py) это вспомогательная программа, исполняемая pyboard, которая принимает сообщения от малины и преобразует их в угол сервопривода и скорость двигателя. 

Программы ![qualification](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/qualification.py), ![final.py](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/final.py) заливаются на малину и имеют схожую структуру. 

Все их можно разделить на 3 этапа работы: 

1. ожидание кнопки 

2. движение 

3. остановка 

(в программе этапы определяются переменной "state") 

На первом этапе малина отправляет сообщение «999999999999999999999$», которое pyboard считывает и ждет изменения значения, параллельно отправляя показания кнопки. 

Когда кнопка нажата, pyboard отсылает сообщение: "1$". 

raspberry получает его и начинает движение. 

В ![qualification](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/qualification.py), второй этап - прохождение с помощью пропорционально-дифференциального регулятора с двумя датчиками и с параллельным считыванием так называемых пере (оранжевая и синяя линии). 

ПД-регулятор сначала вычисляет отклонение (e=dat1-dat2) исходя из показаний датчиков бортика, а затем на его основе вычисляет управляющее воздействие (u = (e * kp + (e - e_old) * kd) (e_old - предыдущее отклонение).  

![final.py](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/final.py) работает аналогично ![qualification](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/qualification.py) но в него добавлены функции обхода знаков. 

На этапе прохождения трассы на экране появляется новый огромный датчик (хотя на самом деле их два), который считывает кубики и возвращает их цвет и положение на камере. 
 
И если робот замечает знак, то вычисляет новое отклонение отнцосительно него, игнорируя черные линии. 
 
Все предыдущие программы были для прохождения трассы, последующие программы понадобятся нам для других целей. 

![RobotAPI.py](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/RobotAPI.py) создает класс, отвечающий за считывание изображения с камеры.  

![start_robot.py](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/start_robot.py) используя ![RobotAPI.py](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/RobotAPI.py) упрощает использование робота. Эта программа создаёт меню, с помощью которого вы можете удобно загрузить программу на робота, запустить или остановить её в любой момент. 

Компьютер подключен к малине по IP с использованием сети Wi-Fi. 
 
В окне, созданном программой, наблюдаем 6 кнопок: "load start", "start", "stop", "raw" , "video" and "connect to robot". 

Если вы запустите ![start_robot.py](https://github.com/AndreySamoylenko/KZAS/blob/main/программы/start_robot.py) и попробуете что-нибудь сделать, программа выведет сообщение о том, что сначала нужно выбрать робота  

Это означает, что прежде чем что-то загружать, нужно знать, куда это загружать. 
В этом случае вам необходимо нажать на кнопку «подключиться к роботу» и выбрать своего робота (предварительно необходимо подключиться к Wi-Fi сети нашего робота). 
После этого заливаем на малину нужную программу (кнопка " load start ") или, если она уже загружена, перезапускаем ее кнопкой "start". 
 
Кнопкой «video» вы можете вывести видео с камеры робота на экран вашего ноутбука в отдельном окне. 
 
В этом же окне будет отображаться телеметрия. 
 
Кнопка «raw» запускает тестовый файл, который выводит изображение с камеры без телеметрии. 
 
Кнопка «stop» останавливает запущенную программу и вывод камеры. 
 
# Подключаемся к pyboard 
 
Для подключения к pyboard необходимо с помощью micro usb кабеля подключить pyboard к компьютеру, и открыть pyboard как флешку в проводнике. 

 
 
